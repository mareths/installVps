# Bannière afficher lorsqu'on se connecte en SMTP sur le port 25
smtpd_banner = $myhostname ESMTP $mail_name (Debian/GNU)
# Service qui envoie des notifications "nouveau message"
biff = no
# Desactive la commande SMTP VRFY. Arrête certaine technique pour avoir des adresses email
disable_vrfy_command = yes
# Impose au client SMTP de démarrer la session SMTP par une commande Helo (ou ehlo)
smtpd_helo_required = yes
# Avec le courier local ça ajoute .NDD aux adresses incomplètes (seulement le nom d'hote)
append_dot_mydomain = no
# Le nom de la machine du système de messagerie
# Par défaut c'est host.domain.tld mais on peut mettre un reverse dns
myhostname = NOM_HOTE
# Le domaine utilisé par defaut pour poster les message local
myorigin = NOM_HOTE
# Liste des domaines pour lequel le serveur doit accepter le courrier
mydestination = NOM_HOTE, localhost.localdomain, localhost
# Pour effectuer des livraisons de courrier avec un relay (ici non)
relayhost =
# Liste des réseaux locaux autorisés
mynetworks = 127.0.0.0/8, IP_EXTERNE
# Taille des boîtes au lettre (0 = illimité)
mailbox_size_limit = 0
# Séparateur entre le nom d'utilisateur et les extensions d'adresses
recipient_delimiter = +
# Interfaces réseaux à écouter (ici toutes)
inet_interfaces = all
inet_protocols = ipv4
# Gestion des boites mails virtuelle
# Contient les fichiers qui permettent de relier postfix  mysql
virtual_alias_maps = mysql:/etc/postfix/mysql-virtual_aliases.cf,mysql:/etc/postfix/mysql-virtual_aliases_comptes.cf
virtual_mailbox_domains = mysql:/etc/postfix/mysql-virtual_domaines.cf
virtual_mailbox_maps = mysql:/etc/postfix/mysql-virtual_comptes.cf
# Le dossier ou seront contenu les mails (=home de l'user vmail)
virtual_mailbox_base = /var/spool/vmail/
# L'id du groupe et de l'utilisateur vmail créé précédement
virtual_uid_maps = static:5000
virtual_gid_maps = static:5000
# Créer un dossier par comte email
#virtual_create_maildirsize = yes
# A activer si vous souhaitez ajouter des quotas
#virtual_mailbox_extended = yes
# Impose les limites au niveau des mails, dans notre cas aucune
#virtual_mailbox_limit_maps = mysql:/etc/postfix/mysql-virtual_quotas.cf
# Ajouter une limite sur la taille des messages pour les boites virtuelles
#virtual_mailbox_limit_override = yes
#virtual_maildir_limit_message = "La boite mail de votre destinataire est pleine, merci de reessayez plus tard."
#virtual_overquota_bounce = yes
# adresses d'expedition + tls
smtpd_sender_restrictions =
        permit_mynetworks,
        warn_if_reject reject_unverified_sender
# adresses de destination
smtpd_recipient_restrictions =
        permit_mynetworks,
	permit_sasl_authenticated,
        reject_unauth_destination
# client
smtpd_client_restrictions =
        permit_mynetworks
 
smtpd_sasl_auth_enable = yes
broken_sasl_auth_clients = yes
smtpd_sasl_authenticated_header = yes
smtpd_use_tls = yes
smtpd_tls_cert_file = /etc/postfix/smtpd.cert
smtpd_tls_key_file = /etc/postfix/smtpd.key
 
#antivirus etc.
content_filter = amavis:[127.0.0.1]:10024
receive_override_options = no_address_mappings
